import{_ as K,a as q}from"./AuthenticatedLayout-COKFtPnh.js";import{k as u,T as P,c as b,a as i,u as c,w as a,F as Z,o as C,Z as Q,b as r,t as d,d as s,r as M,p as U,q as G}from"./app-BuWHEnaa.js";import{_ as z,a as k}from"./Modal-CZK5Uuik.js";import{_ as $}from"./PrimaryButton-Bu-PBff2.js";import{D as J}from"./DangerButton-C5Uk6ASa.js";import{_ as W}from"./AlertSuccess-B9TR9wdG.js";import{_ as X}from"./DarkButton-WfxyzJVq.js";import{_ as R}from"./SelectGroup-GSNR2jGF.js";import{_ as Y}from"./AlertWarning-7QtOTzyG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./InputError-DY0SectE.js";const oo={class:"p-4 bg-white rounded-lg shadow-xs"},so={class:"inline-flex overflow-hidden mb-4 w-full bg-white rounded-lg shadow-md"},eo={class:"px-4 py-2 -mx-3"},to={class:"mx-3"},lo={class:"overflow-hidden mb-8 w-full rounded-lg border shadow-xs"},io={class:"overflow-x-auto w-full"},ao={class:"w-full whitespace-no-wrap"},no={class:"bg-white divide-y"},ro={class:"px-4 py-3 text-sm"},uo={class:"px-4 py-3 text-sm"},co={class:"px-4 py-3 text-sm"},fo={class:"px-4 py-3 text-sm"},go={class:"px-4 py-3 text-xs"},mo={class:"px-4 py-3 text-sm"},po={class:"px-4 py-3 text-sm"},_o={class:"px-4 py-3 text-xs"},vo={class:"px-4 py-3 text-sm"},xo={class:"p-6"},ho={class:"text-2x1 font-medium text-orange-700"},wo={class:"text-2x1 font-medium text-purple-800"},yo={class:"m-6 flex justify-end"},bo={class:"p-6"},Co={class:"text-2x1 font-medium text-orange-700"},Mo={class:"text-2x1 font-medium text-purple-800"},ko={class:"m-6 flex justify-end"},No={__name:"ListaColonias",props:{Colonias:{type:Object},Refugios:{type:Object},flash:{type:Object}},setup(A){const j=u([]),E=u([]);u([]),u([]);let p=u([]),_=u([]);const n=A,t=P({id:0,refugio_id:0,numero:0,latitud:0,longitud:0,activado:0,refugiocolonia_id:0,zona:"",refugioruta_id:0,ruta:"",colonia1_id:0,colonia1:"",colonia_id:0,colonia:"",comunidad_id:0,comunidad:"",tipocomunidad_id:0,tipocomunidad:0,nuevo_refugio_id:0,nuevo_refugio:""});n.Colonias.map(e=>j.value.push({id:e.id,text:e.colonia+" "+e.comunidad+" "+e.id})),n.Refugios.map(e=>E.value.push({id:e.id,text:e.refugio+" ("+e.numero+")"}));const v=u(!1),x=u(!1),h=u(n.flash.success!=null?"":"hidden"),g=u("hidden"),m=u(n.flash.success!=null?n.flash.success:""),D=e=>{g.value="hidden",p.value=[],t.id=e.target.value,console.log(t.id),B()},B=async()=>{console.log(t.id);try{const e=await G.post("getRefugiosFromColoniasAuth",t).then(o=>{console.log("Datos recibidos:",o.data.refugios.original.mensaje),o.data.refugios.original.mensaje==="OK"?(p.value=o.data.refugios.original,console.log("Colonia recibida:",o.data.colonia.colonia),_.value=o.data.colonia,S(_.value)):g.value="block"}).catch(o=>{console.log("Error:",o.message)})}catch(e){console.error("Error al obtener los datos: ",e.message)}},S=e=>{t.id=e.id,t.numero=e.numero,t.colonia1=e.colonia1,t.colonia1_id=e.colonia1_id,t.colonia=e.colonia,t.colonia_id=e.colonia_id,t.activado=e.activado,t.comunidad=e.comunidad,t.comunidad_id=e.comunidad_id,t.tipocomunidad=e.tipocomunidad,t.tipocomunidad_id=e.tipocomunidad_id,t.refugio_id=e.refugio_id,t.refugiocolonia_id=e.refugiocolonia_id,t.refugioruta_id=e.refugioruta_id,t.ruta=e.ruta,t.zona=e.zona,t.latitud=e.latitud,t.longitud=e.longitud},L=async e=>{g.value="hidden",t.nuevo_refugio_id=e.target.value,t.nuevo_refugio=e.target.text,console.log(t.nuevo_refugio_id+"_"+t.colonia_id)},N=e=>{t.refugio_id=e.id,v.value=!0},O=e=>{x.value=!0},w=()=>{v.value=!1},y=()=>{x.value=!1},V=()=>{console.log(t.refugio_id+" "+t.id),t.post(route("coloniarefugio.destroy",t),{onSuccess:()=>{n.flash.mensaje==="OK"?f(n.flash.success):f(n.flash.error)},onError:()=>{f(n.flash.error)}})},H=()=>{console.log(t.nuevo_refugio_id+" "+t.id),t.post(route("coloniarefugio.add",t),{onSuccess:()=>{n.flash.mensaje==="OK"?f(n.flash.success):f(n.flash.error)},onError:()=>{f(n.flash.error)}})},f=e=>{w(),y(),m.value=e,console.log(m.value),h.value="block bg-warning-800",setTimeout(()=>{h.value="hidden",m.value="",B()},3e3)},F=e=>{window.open("/refugios-getPosition.php?id="+e.id)};var I="Colonias";return(e,o)=>(C(),b(Z,null,[i(c(Q),{title:"Colonias"}),i(K,null,{header:a(()=>[r(d(c(I)),1)]),default:a(()=>[s("div",oo,[s("div",so,[s("div",eo,[s("div",to,[i(R,{opciones:j.value,onChange:o[0]||(o[0]=l=>D(l)),errors:c(t).errors.colonia_id,"class-especial":"em25 bg-yellow-50"},null,8,["opciones","errors"])])]),i($,{onClick:o[1]||(o[1]=l=>O(c(t))),title:"Agregar refugio",type:"default",classBtn:"px-3 py-2 mt-3 text-sm font-medium leading-5 text-white transition-colors duration-150 rojo-morena border border-transparent rounded-lg active:bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:shadow-outline-emerald"},{default:a(()=>[M(e.$slots,"icon",{},()=>[o[3]||(o[3]=s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-6"},[s("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 9a.75.75 0 0 0-1.5 0v2.25H9a.75.75 0 0 0 0 1.5h2.25V15a.75.75 0 0 0 1.5 0v-2.25H15a.75.75 0 0 0 0-1.5h-2.25V9Z","clip-rule":"evenodd"})],-1))])]),_:3})]),i(W,{classMsg:h.value,Msg:m.value,classIcon:"text-green-800"},{default:a(()=>[M(e.$slots,"icon",{},()=>[o[4]||(o[4]=s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-6"},[s("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022ZM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"})],-1))])]),_:3},8,["classMsg","Msg"]),s("div",lo,[s("div",io,[s("table",ao,[o[6]||(o[6]=s("thead",null,[s("tr",{class:"text-xs font-bold tracking-wide text-left text-blue-500 uppercase bg-gray-300 border-b"},[s("th",{class:"px-4 py-3"},"ID"),s("th",{class:"px-4 py-3"},"Número"),s("th",{class:"px-4 py-3"},"Refugio"),s("th",{class:"px-4 py-3"},"Ubicación"),s("th",{class:"px-4 py-3"},"Infraestructra"),s("th",{class:"px-4 py-3"},"Capacidad"),s("th",{class:"px-4 py-3"},"Enlace"),s("th",{class:"px-4 py-3"},"Teléfonos"),s("th",{class:"px-4 py-3"})])],-1)),s("tbody",no,[(C(!0),b(Z,null,U(c(p).data,l=>(C(),b("tr",{key:l.id,class:"text-gray-700"},[s("td",ro,d(l.id),1),s("td",uo,[i(q,{href:e.route("refugio.edit",l.id)},{default:a(()=>[i(k,{title:"Editar refugio"},{default:a(()=>[r(d(l.numero),1)]),_:2},1024)]),_:2},1032,["href"])]),s("td",co,[i(X,{onClick:T=>F(l),title:"Cambiar la geolocalización"},{default:a(()=>[r(d(l.refugio),1)]),_:2},1032,["onClick"])]),s("td",fo,d(l.ubicacion),1),s("td",go,d(l.infraestructura),1),s("td",mo,d(l.capacidad),1),s("td",po,d(l.enlace),1),s("td",_o,d(l.telefonos),1),s("td",vo,[i(J,{onClick:T=>N(l),title:"Eliminar refugio"},{default:a(()=>o[5]||(o[5]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})],-1)])),_:2},1032,["onClick"])])]))),128))])]),i(Y,{classMsg:g.value,Msg:"No se encontraron Refugios",classIcon:"text-orange-800"},{default:a(()=>[M(e.$slots,"icon",{},()=>[o[7]||(o[7]=s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"size-6"},[s("path",{"fill-rule":"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"})],-1))])]),_:3},8,["classMsg"])])])]),i(z,{show:v.value,onClose:w},{default:a(()=>[s("div",xo,[s("p",null,[o[8]||(o[8]=r(" ¿Quiéres quitar ")),s("span",ho,d(c(_).colonia),1),o[9]||(o[9]=r(" del refugio ")),s("span",wo,d(c(t).refugio),1),o[10]||(o[10]=r(" ? "))])]),s("div",yo,[i($,{onClick:V,class:"mr-4","class-btn":"rojo-morena"},{default:a(()=>o[11]||(o[11]=[r("Si, elimínalo")])),_:1}),i(k,{onClick:w},{default:a(()=>o[12]||(o[12]=[r("Cancelar")])),_:1})])]),_:1},8,["show"]),i(z,{show:x.value,onClose:y},{default:a(()=>[s("div",bo,[i(R,{opciones:E.value,onChange:o[2]||(o[2]=l=>L(l)),errors:c(t).errors.refugio,"class-especial":"em25 bg-yellow-50"},null,8,["opciones","errors"]),o[16]||(o[16]=s("br",null,null,-1)),o[17]||(o[17]=s("br",null,null,-1)),s("p",null,[o[13]||(o[13]=r(" ¿Quiéres agregar el refugio ")),s("span",Co,d(c(t).nuevo_refugio),1),o[14]||(o[14]=r(" a la colonia ")),s("span",Mo,d(c(t).colonia),1),o[15]||(o[15]=r(" ? "))])]),s("div",ko,[i($,{onClick:H,class:"mr-4","class-btn":"rojo-morena"},{default:a(()=>o[18]||(o[18]=[r("Agregar")])),_:1}),i(k,{onClick:y},{default:a(()=>o[19]||(o[19]=[r("Cancelar")])),_:1})])]),_:1},8,["show"])]),_:3})],64))}};export{No as default};
